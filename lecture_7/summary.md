# 第七章 Feature Detection学习总结

## 1. 基于图像的特征点检测

基于图像的特征点检测有非常多的方法，课程中提到的有Harris、SUSAN(Small Univalue Segment Assimilating Nucleus)、SIFT(Scale-Invariant Feature Transform)。

课程中对于图像的特征点检测，只介绍了Harris，它的主要思想是通过图像中的像素梯度变化找到图像中x和y方向都变化很大的点。

对于图像中的一个patch，它的像素强度变化为：
$$
E(u,v) = \sum_{x,y} w(x,y) [I(x+u, y+v) - I(x,y)]^2
$$
将上式子进行一阶泰勒展开，然后写成矩阵的形式，然后对其中的M矩阵执行特征分解。

我们一般想要的是角点，对于角点它的两个特征值都比较大。

课程中还介绍了很多种Response Function R来判定一个点是不是特征点。

## 2.基于三维点云的特征点检测

对于三维情况下的特征点检测，课程中介绍了Harris 3D和ISS。

### 2.1 Harris 3D

它是对2D Harris的一种推广，课程中对于Harris 3D介绍了两种方案，一种是基于激光点云强度，一种是基于拟合平面距离。

__基于点云强度__

对于基于点云强度的方法，其思路与图像的一模一样，但是由于在图像中$I_x,I_y$很容易求得，在点云中由于没有邻近关系，所以求$I_x,I_y,I_z$会相对复杂一些。

对于梯度的求解，可以使用最小二乘法找到一个梯度向量$e$.

为了降低噪声点的影响，还可以对特征点的梯度进行投影，选择垂直特征点平面法向量的投影作为最终的梯度，可以有效的降低噪声点的影响。

但是与图像不同的是，对于图像其最小特征值大于一个阈值就认为是特征点，所以图像一般选最后一个特征值，但是对于三维点云，并不是这样，实际上一个三维点云的前两个维度就可以形成一个特征点，例如地面上的斑马线，其角点就是一个特征点，所以在三维点云情况，一般是判断第二个特征值是否大于某一个阈值。

> 详细过程参考ppt

__基于距离__

对于没有强度信息的点云，也可以使用一个特定的距离作为其函数值。

其大致的思想是，某一个局部点云，它们可以组成的一个曲面$C$，其中的一个特征点所在的平面$F$(垂直改点法线的平面)，当该特征点移动$[u,v,w]$时，其在局部曲面$C$上会有一个点，这个点到平面$F$会有一个距离。而通过这个距离就能组成最后的代价函数。

更形象的来理解，可以想象，如果在地面上的点，将它沿着$x,y$方向进行移动，其代价函数均为零，但是如果是一个弯曲的角度附近，沿着$x,y,z$方向移动，其代价函数就会在$x,y,z$方向上都产生一个很大的变化。

### 2.2 ISS

ISS特征点的核心思想是，认为在特征点附近会集中大量的点。所以基于这一点问题就变得很简单了，直接对一个局部点云执行PCA，如果最小特征值也大于某一个阈值，则就认为该点是一个特征点。

在做特征点提取时论文提出了几个技巧：

- 给点增加权重，那些距离特征点近的点权重更大，距离远的点权重小一些；
- 协方差矩阵需要考虑权重；
- 特征值要从大到小排列；
- 要对特征值进行判断，去除平面点和线；
- 要进行NMS(非极大值抑制)，目的是保证某一个区域之内只得到一个最小特征值最大的那一个。

### 2.3 无监督的特征点检测算法 USIP

其核心思想就是，一个点云如果进行旋转之后，其特征点依然还是特征点，所以可以对一个点云进行旋转，然后分别在两个点云中执行特征点检测，然后比较两个检测出来的特征点，它们如果确实是一个特征点，那么它们应该只相差一个旋转，然后通过最小化这个距离，就能训练出一个无监督的网络。